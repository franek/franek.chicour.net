<!doctype html><html lang=fr dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Créer une basebox CentOS-6.2 pour vagrant | ::franek::</title><meta name=keywords content="geek,basebox,CentOS,french,ruby,vagrant,veewee,virtualbox"><meta name=description content="Vagrant est un logiciel écrit en Ruby permettant de simplifier la gestion des machines virtuelles dans un environnement de développement. Il va permettre de décrire (via un système de provisionning : puppet, chef, script sh) les composants nécessaires à un projet (php, mysql, &mldr;).
Si vous souhaitez en savoir plus sur vagrant, je vous invite à consulter cette présentation.
Vagrant fournit, par défaut, des box sous Ubuntu (Lucid et Precise)."><meta name=author content="franek"><link rel=canonical href=https://franek.chicour.net/post/creer-une-basebox-centos-6-2-pour-vagrant/><meta name=google-site-verification content="XYZabc"><link href=https://franek.chicour.net/assets/css/stylesheet.min.b6e4fb9d9486ee9750cbbe1b4e388ff4332a2d1e0d17ab3592ecb6c6f7ba1157.css integrity="sha256-tuT7nZSG7pdQy74bTjiP9DMqLR4NF6s1kuy2xve6EVc=" rel="preload stylesheet" as=style><link rel=icon href=https://franek.chicour.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://franek.chicour.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://franek.chicour.net/favicon-32x32.png><link rel=apple-touch-icon href=https://franek.chicour.net/apple-touch-icon.png><link rel=mask-icon href=https://franek.chicour.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.79.1"><meta property="og:title" content="Créer une basebox CentOS-6.2 pour vagrant"><meta property="og:description" content="Vagrant est un logiciel écrit en Ruby permettant de simplifier la gestion des machines virtuelles dans un environnement de développement. Il va permettre de décrire (via un système de provisionning : puppet, chef, script sh) les composants nécessaires à un projet (php, mysql, &mldr;).
Si vous souhaitez en savoir plus sur vagrant, je vous invite à consulter cette présentation.
Vagrant fournit, par défaut, des box sous Ubuntu (Lucid et Precise)."><meta property="og:type" content="article"><meta property="og:url" content="https://franek.chicour.net/post/creer-une-basebox-centos-6-2-pour-vagrant/"><meta property="og:image" content="https://franek.chicour.net/60"><meta property="article:published_time" content="2012-06-02T11:54:00+02:00"><meta property="article:modified_time" content="2013-03-11T22:49:57+01:00"><meta property="og:site_name" content="::franek::"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://franek.chicour.net/60"><meta name=twitter:title content="Créer une basebox CentOS-6.2 pour vagrant"><meta name=twitter:description content="Vagrant est un logiciel écrit en Ruby permettant de simplifier la gestion des machines virtuelles dans un environnement de développement. Il va permettre de décrire (via un système de provisionning : puppet, chef, script sh) les composants nécessaires à un projet (php, mysql, &mldr;).
Si vous souhaitez en savoir plus sur vagrant, je vous invite à consulter cette présentation.
Vagrant fournit, par défaut, des box sous Ubuntu (Lucid et Precise)."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Créer une basebox CentOS-6.2 pour vagrant","name":"Créer une basebox CentOS-6.2 pour vagrant","description":"Vagrant est un logiciel écrit en Ruby permettant de simplifier la gestion des machines virtuelles dans un environnement de développement. Il va permettre de décrire (via un système …","keywords":["geek","basebox","CentOS","french","ruby","vagrant","veewee","virtualbox"],"articleBody":"Vagrant est un logiciel écrit en Ruby permettant de simplifier la gestion des machines virtuelles dans un environnement de développement. Il va permettre de décrire (via un système de provisionning : puppet, chef, script sh) les composants nécessaires à un projet (php, mysql, …).\nSi vous souhaitez en savoir plus sur vagrant, je vous invite à consulter cette présentation.\nVagrant fournit, par défaut, des box sous Ubuntu (Lucid et Precise).\nIl est possible de récupérer des box créés par la communautés sur le site vagrantbox.es pour la plupart des distributions LINUX.\nJ’ai besoin d’une box (vagrant) CentOS-6.2 avec Puppet. Sauf erreur, ce type de VM n’est pas disponible sur site vagrantbox.es. Je vais donc la créer grâce à veewee qui est un utilitaire écrit en Ruby permettant de créer des box pour Vagrant.\nPré-requis :\n avoir installé VirtualBox avoir installé vagrant (qui est désormais dans les dépôts Ubuntu (sudo apt-get install vagrant))  Installation de veewe $ sudo gem install veewee $ sudo gem install bundler L’installation de veewee va ajouter l’ensemble des commandes vagrant basebox.\nPour vérifier que veewee a bien été installé, vous pouvez lancer la commande :\n$ vagrant basebox Cela devrait retourner :\nUsage: vagrant basebox  [] Available subcommands: build define destroy export list ostypes templates undefine validate For help on any individual command run `vagrant basebox COMMAND -h` Veewee vient, par défaut, avec des templates de création de machine virtuelle. Pour lister l’ensemble des templates existant :\n$ vagrant basebox templates Cerise sur le gâteau, veewee dispose de plusieurs templates pour CentOS. Nous allons utiliser le template ‘CentOS-6.2-x86_64-minimal’ dans la suite de ce document.\nCréation de la “basebox” pour vagrant Nous allons lancer la création d’une machine virtuelle à partir du template ‘CentOS-6.2-x86_64-minimal’.\n $ vagrant basebox define 'centos-6.2' 'CentOS-6.2-x86_64-minimal' centos-6.2 est un nom arbitraire. Il peut être remplacé par un nom qui vous semblera plus parlant.\nCette commande va créer un répertoire definitions qui contiendra des scripts de configuration de la VM. Il est possible de les éditer pour coller à l’environnement souhaité.\nNotamment, par défaut, les machines virtuelles sont configurées pour utiliser des locales américaines. Il est possible de le changer en éditant le fichier definitions/centos-6.2/ks.cfg :\n$ vi definitions/centos-6.2/ks.cfg # valeurs à utiliser pour avoir l'OS en français (avec un clavier français) lang fr_FR.UTF-8 keyboard fr On lance ensuite la création de la machine virtuelle :\n $ vagrant basebox build 'centos-6.2' Cette commande va :\n télécharger l’ISO associer au template choisi (ici, CentOS-6.2-x86_64-minimal.iso). L’iso sera placé dans le répertoire iso. vérifier le checksum de l’iso lancer VirtualBox avec l’iso exécuter les différents scripts présents dans le répertoire definitions.  Cela peut prendre quelques temps. Lorsque l’installation est terminée, vous pouvez vérifier la machine virtuelle :\n $ vagrant basebox validate centos-6.2 Ou l’exporter pour l’utiliser comme machine virtuelle vagrant :\n $ vagrant basebox export centos-6.2 Pour commencer à utiliser la machine virtuelle créée avec vagrant :\n $ vagrant box add centos-6.2 centos-6.2.box $ vagrant init centos-6.2 $ vagrant up Vous pouvez également partager cette basebox sur un serveur. D’autres utilisateurs pourront ainsi l’utiliser via une commande du type :\n $ vagrant box add centos-6.2 http://mon-serveur-web/chemin/vers/centos-6.2.box $ vagrant init centos-6.2 $ vagrant up La prochaine étape va être d’ajouter les éléments spécifiques à mon projet dans la basebox. Deux options s’ouvrent à moi :\n utiliser un système de provisionning (type puppet ou chef) modifier les scripts décrivant cette basebox (répertoire definitions) pour ajouter de base l’ensemble des logiciels dont j’ai besoin (php5, apache, oci8, …). Je serai donc obligé de récréer cet environnement, ce qui peut être un peu plus fastidieux.  La suite au prochain épisode…\n","wordCount":"600","inLanguage":"fr","datePublished":"2012-06-02T11:54:00+02:00","dateModified":"2013-03-11T22:49:57+01:00","author":[{"@type":"Person","name":"franek"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://franek.chicour.net/post/creer-une-basebox-centos-6-2-pour-vagrant/"},"publisher":{"@type":"Organization","name":"::franek::","logo":{"@type":"ImageObject","url":"https://franek.chicour.net/favicon.ico"}}}</script></head><body id=top><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://franek.chicour.net accesskey=h title="::franek:: (Alt + H)"><img src=/public/logo-franek.png alt=logo aria-label=logo height=35>::franek::</a>
<span class=logo-switches></span></div><ul class=menu id=menu onscroll=menu_on_scroll()><li><a href=https://franek.chicour.net/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://franek.chicour.net/archive/ title=Archives><span>Archives</span></a></li><li><a href=https://franek.chicour.net/search/ title="Recherche (Alt + /)" accesskey=/><span>Recherche</span></a></li><li><a href=https://franek.chicour.net/feed/rss2 title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Créer une basebox CentOS-6.2 pour vagrant</h1><div class=post-meta>June 2, 2012&nbsp;·&nbsp;franek</div></header><div class=post-content><p><a href=https://franek.chicour.net/post/2012/06/02/vagrantup.com/>Vagrant</a> est un logiciel écrit en Ruby permettant de simplifier la gestion des machines virtuelles dans un environnement de développement. Il va permettre de décrire (via un système de provisionning : puppet, chef, script sh) les composants nécessaires à un projet (php, mysql, &mldr;).</p><p>Si vous souhaitez en savoir plus sur vagrant, je vous invite à consulter <a href=http://www.ichilton.co.uk/blog/virtualization/my-phpne-talk-on-vagrant-496.html>cette présentation</a>.</p><p>Vagrant <a href=https://github.com/mitchellh/vagrant/wiki/Available-Vagrant-Boxes>fournit</a>, par défaut, des box sous Ubuntu (Lucid et Precise).</p><p>Il est possible de récupérer des box créés par la communautés sur le <a href=http://vagrantbox.es/>site vagrantbox.es</a> pour la plupart des distributions LINUX.</p><p>J&rsquo;ai besoin d&rsquo;une box (vagrant) CentOS-6.2 avec Puppet. Sauf erreur, ce type de VM n&rsquo;est pas disponible sur <a href=http://vagrantbox.es/>site vagrantbox.es</a>. Je vais donc la créer grâce à <a href=https://github.com/jedi4ever/veewee>veewee</a> qui est un utilitaire écrit en Ruby permettant de créer des box pour Vagrant.</p><p>Pré-requis :</p><ul><li>avoir installé VirtualBox</li><li>avoir installé vagrant (qui est désormais dans les dépôts Ubuntu (<code>sudo apt-get install vagrant</code>))</li></ul><h2 id=installation-de-veewe>Installation de veewe<a hidden class=anchor aria-hidden=true href=#installation-de-veewe>#</a></h2><pre><code>$ sudo gem install veewee
$ sudo gem install bundler

</code></pre><p>L&rsquo;installation de veewee va ajouter l&rsquo;ensemble des commandes <em>vagrant basebox</em>.</p><p>Pour vérifier que veewee a bien été installé, vous pouvez lancer la commande :</p><pre><code>$ vagrant basebox

</code></pre><p>Cela devrait retourner :</p><pre><code>Usage: vagrant basebox &lt;command&gt; [&lt;args&gt;]

Available subcommands:
     build
     define
     destroy
     export
     list
     ostypes
     templates
     undefine
     validate

For help on any individual command run `vagrant basebox COMMAND -h`

</code></pre><p>Veewee vient, par défaut, avec des templates de création de machine virtuelle. Pour lister l&rsquo;ensemble des templates existant :</p><pre><code>$ vagrant basebox templates

</code></pre><p>Cerise sur le gâteau, veewee dispose de plusieurs templates pour CentOS. Nous allons utiliser le template &lsquo;CentOS-6.2-x86_64-minimal&rsquo; dans la suite de ce document.</p><h2 id=création-de-la-basebox-pour-vagrant>Création de la &ldquo;basebox&rdquo; pour vagrant<a hidden class=anchor aria-hidden=true href=#création-de-la-basebox-pour-vagrant>#</a></h2><p>Nous allons lancer la création d&rsquo;une machine virtuelle à partir du template &lsquo;CentOS-6.2-x86_64-minimal&rsquo;.</p><pre><code> $ vagrant basebox define 'centos-6.2'  'CentOS-6.2-x86_64-minimal'

</code></pre><p>centos-6.2 est un nom arbitraire. Il peut être remplacé par un nom qui vous semblera plus parlant.</p><p>Cette commande va créer un répertoire <strong>definitions</strong> qui contiendra des scripts de configuration de la VM. Il est possible de les éditer pour coller à l&rsquo;environnement souhaité.</p><p>Notamment, par défaut, les machines virtuelles sont configurées pour utiliser des locales américaines. Il est possible de le changer en éditant le fichier definitions/centos-6.2/ks.cfg :</p><pre><code>$ vi definitions/centos-6.2/ks.cfg

# valeurs à utiliser pour avoir l'OS en français (avec un clavier français)
lang fr_FR.UTF-8
keyboard fr 

</code></pre><p>On lance ensuite la création de la machine virtuelle :</p><pre><code> $ vagrant basebox build 'centos-6.2'

</code></pre><p>Cette commande va :</p><ul><li>télécharger l&rsquo;ISO associer au template choisi (ici, CentOS-6.2-x86_64-minimal.iso). L&rsquo;iso sera placé dans le répertoire iso.</li><li>vérifier le checksum de l&rsquo;iso</li><li>lancer VirtualBox avec l&rsquo;iso</li><li>exécuter les différents scripts présents dans le répertoire definitions.</li></ul><p>Cela peut prendre quelques temps. Lorsque l&rsquo;installation est terminée, vous pouvez vérifier la machine virtuelle :</p><pre><code> $ vagrant basebox validate centos-6.2

</code></pre><p>Ou l&rsquo;exporter pour l&rsquo;utiliser comme machine virtuelle vagrant :</p><pre><code> $ vagrant basebox export centos-6.2

</code></pre><p>Pour commencer à utiliser la machine virtuelle créée avec vagrant :</p><pre><code> $ vagrant box add centos-6.2 centos-6.2.box
 $ vagrant init centos-6.2
 $ vagrant up

</code></pre><p>Vous pouvez également partager cette basebox sur un serveur. D&rsquo;autres utilisateurs pourront ainsi l&rsquo;utiliser via une commande du type :</p><pre><code> $ vagrant box add centos-6.2 http://mon-serveur-web/chemin/vers/centos-6.2.box
 $ vagrant init centos-6.2
 $ vagrant up

</code></pre><p>La prochaine étape va être d&rsquo;ajouter les éléments spécifiques à mon projet dans la basebox. Deux options s&rsquo;ouvrent à moi :</p><ul><li>utiliser un système de provisionning (type puppet ou chef)</li><li>modifier les scripts décrivant cette basebox (répertoire definitions) pour ajouter de base l&rsquo;ensemble des logiciels dont j&rsquo;ai besoin (php5, apache, oci8, &mldr;). Je serai donc obligé de récréer cet environnement, ce qui peut être un peu plus fastidieux.</li></ul><p>La suite au prochain épisode&mldr;</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://franek.chicour.net/tags/geek/>geek</a></li><li><a href=https://franek.chicour.net/tags/basebox/>basebox</a></li><li><a href=https://franek.chicour.net/tags/centos/>CentOS</a></li><li><a href=https://franek.chicour.net/tags/french/>french</a></li><li><a href=https://franek.chicour.net/tags/ruby/>ruby</a></li><li><a href=https://franek.chicour.net/tags/vagrant/>vagrant</a></li><li><a href=https://franek.chicour.net/tags/veewee/>veewee</a></li><li><a href=https://franek.chicour.net/tags/virtualbox/>virtualbox</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://franek.chicour.net>::franek::</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=https://franek.chicour.net/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});if(id==="top"){history.replaceState(null,null," ");}else{history.replaceState(null,null,`#${id}`);}});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script></body></html>