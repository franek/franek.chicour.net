<!doctype html><html lang=fr dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Cherokee et dotclear sont dans un bâteau... | ::franek::</title><meta name=keywords content="développement web,cherokee,dotclear,installation"><meta name=description content="Ce blog et une partie de ces satellites (migration en cours) tournent désormais sur cherokee, un serveur web léger concurrent de Apache, Lighthttpd, nginx,&mldr; Je n&rsquo;ai pas trouvé de ressources sur la configuration de dotclear avec Cherokee donc voici quelques notes. J&rsquo;espère que cela pourra aider certains d&rsquo;entre vous. J&rsquo;essaierai de détailler si besoin.
Installation de cherokee Je vous invite à lire la documentation du projetqui est relativement complète.
La version 1."><meta name=author content="franek"><link rel=canonical href=https://franek.chicour.net/post/cherokee-et-dotclear-sont-dans-un-bateau/><meta name=google-site-verification content="XYZabc"><link href=https://franek.chicour.net/assets/css/stylesheet.min.b6e4fb9d9486ee9750cbbe1b4e388ff4332a2d1e0d17ab3592ecb6c6f7ba1157.css integrity="sha256-tuT7nZSG7pdQy74bTjiP9DMqLR4NF6s1kuy2xve6EVc=" rel="preload stylesheet" as=style><link rel=icon href=https://franek.chicour.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://franek.chicour.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://franek.chicour.net/favicon-32x32.png><link rel=apple-touch-icon href=https://franek.chicour.net/apple-touch-icon.png><link rel=mask-icon href=https://franek.chicour.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.79.1"><meta property="og:title" content="Cherokee et dotclear sont dans un bâteau..."><meta property="og:description" content="Ce blog et une partie de ces satellites (migration en cours) tournent désormais sur cherokee, un serveur web léger concurrent de Apache, Lighthttpd, nginx,&mldr; Je n&rsquo;ai pas trouvé de ressources sur la configuration de dotclear avec Cherokee donc voici quelques notes. J&rsquo;espère que cela pourra aider certains d&rsquo;entre vous. J&rsquo;essaierai de détailler si besoin.
Installation de cherokee Je vous invite à lire la documentation du projetqui est relativement complète.
La version 1."><meta property="og:type" content="article"><meta property="og:url" content="https://franek.chicour.net/post/cherokee-et-dotclear-sont-dans-un-bateau/"><meta property="og:image" content="https://franek.chicour.net/60"><meta property="article:published_time" content="2010-05-28T18:48:00+02:00"><meta property="article:modified_time" content="2011-10-16T21:34:54+02:00"><meta property="og:site_name" content="::franek::"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://franek.chicour.net/60"><meta name=twitter:title content="Cherokee et dotclear sont dans un bâteau..."><meta name=twitter:description content="Ce blog et une partie de ces satellites (migration en cours) tournent désormais sur cherokee, un serveur web léger concurrent de Apache, Lighthttpd, nginx,&mldr; Je n&rsquo;ai pas trouvé de ressources sur la configuration de dotclear avec Cherokee donc voici quelques notes. J&rsquo;espère que cela pourra aider certains d&rsquo;entre vous. J&rsquo;essaierai de détailler si besoin.
Installation de cherokee Je vous invite à lire la documentation du projetqui est relativement complète.
La version 1."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Cherokee et dotclear sont dans un bâteau...","name":"Cherokee et dotclear sont dans un bâteau...","description":"Ce blog et une partie de ces satellites (migration en cours) tournent désormais sur cherokee, un serveur web léger concurrent de Apache, Lighthttpd, nginx,\u0026amp;hellip; Je n\u0026amp;rsquo;ai …","keywords":["développement web","cherokee","dotclear","installation"],"articleBody":"Ce blog et une partie de ces satellites (migration en cours) tournent désormais sur cherokee, un serveur web léger concurrent de Apache, Lighthttpd, nginx,… Je n’ai pas trouvé de ressources sur la configuration de dotclear avec Cherokee donc voici quelques notes. J’espère que cela pourra aider certains d’entre vous. J’essaierai de détailler si besoin.\nInstallation de cherokee Je vous invite à lire la documentation du projetqui est relativement complète.\nLa version 1.0 de Cherokee est depuis peu disponible dans la branche testing de Debian.\nSi vous utilisez une debian stable, vous pouvez utiliser le système de Pinning en utilisant les dépôts testing :\napt-get install cherokee -t testing Il faudra également que vous installiez le paquet php5-cgi ainsi que mysql. Il y a plein de tutos sur le net sur ce sujet.\nConfiguration de Dotclear Je vous invite à suivre la procédure habituelle. Dans mon cas, dotclear est installé dans le répretoire /usr/share/dotclear-2.1.7. J’ai un lien symbolique dotclear2 qui pointe sur dotclear-2.1.7 (qui permet de switcher d’une version à l’autre).\nJ’ai un répertoire /usr/share/dotclear2-all-blogs qui contient les thèmes et les plugins communs à l’ensemble des blogs hébergés.\nJ’utilise dotclear en multiblog. Chaque blog dispose dispose des plugins communs. Les thèmes ne sont pas partagés. Chaque blog dispose de son sous-domaine :\nexemple : user1.domain.net, user2.domain.net\nCes blogs sont hébergés dans /var/www/\nExemple :\n /var/www/domain.net/user1/public_html pour user1.domain.net /var/www/domain.net/user2/public_html pour user2.domain.net  Dans chaque répertoire public_html, j’ai donc un fichier index.php dont l’identifiant du blog a été modifié et dont le chemin du require a été modifié :\ndefine('DC_BLOG_ID','user1'); # identifiant du blog\nrequire '/usr/share/dotclear2/inc/public/prepend.php';\nDans le fichier de configuration, j’ai ajouté les lignes suivantes afin de charger les thèmes dans les profils utilisateurs :\n// Modification de la configuration du blog lors de l'initialisation\n// cf. http://forum.dotclear.net/viewtopic.php?id=33875\n$__top_behaviors[] = array('coreBlogConstruct','modifConfig');\n\nfunction modifConfig($blog) {\n $blog-themes_path = '/var/www/domain.net/'.$blog-id.'/public_html/themes';\n $blog-public_path = '/var/www/domain.net/'.$blog-id.'/public_html/public';\n}\nTous les blogs sont configurés en mode PATH_INFO.\nConfiguration de cherokee La configuration de cherokee est ultra-basique. J’ai un v-servers pour l’ensemble des blogs hébergés.\nDes copies d’écran étant souvent plus parlantes que de longs discours, voici ma configuration :\nConfiguration générale du v-server \nConfiguration des behaviors Il est nécessaire d’ajouter au mininum 3 behaviors :\n Un behavior PHP (afin de pouvoir traiter les requêtes PHP) Un behavior admin permettant d’accéder à l’interface d’administration. Le behavor sur le répertoire admin pointe sur /usr/share/dotclear2/admin. Modifier le behavior “Par défaut” afin qu’il agisse en tant que redirection vers le fichier index.php (gestion des URL en mode PATH_INFO, suppression de index.php)  \nConfiguration du Behavior par défaut Cette configuration est nécessaire si vous souhaitez supprimer le fichier index.php dans les URL et que vous utilisez le mode PATH_INFO.\n\nJe n’ai pas encore configuré cherokee afin qu’il gère correctement le cache des contenus statiques (ajout de date d’expiration,…). Si ce n’est pas clair, n’hésitez pas à commenter, j’essaierai de compléter.\n","wordCount":"468","inLanguage":"fr","datePublished":"2010-05-28T18:48:00+02:00","dateModified":"2011-10-16T21:34:54+02:00","author":[{"@type":"Person","name":"franek"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://franek.chicour.net/post/cherokee-et-dotclear-sont-dans-un-bateau/"},"publisher":{"@type":"Organization","name":"::franek::","logo":{"@type":"ImageObject","url":"https://franek.chicour.net/favicon.ico"}}}</script></head><body id=top><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://franek.chicour.net accesskey=h title="::franek:: (Alt + H)"><img src=/public/logo-franek.png alt=logo aria-label=logo height=35>::franek::</a>
<span class=logo-switches></span></div><ul class=menu id=menu onscroll=menu_on_scroll()><li><a href=https://franek.chicour.net/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://franek.chicour.net/archive/ title=Archives><span>Archives</span></a></li><li><a href=https://franek.chicour.net/search/ title="Recherche (Alt + /)" accesskey=/><span>Recherche</span></a></li><li><a href=https://franek.chicour.net/feed/rss2 title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Cherokee et dotclear sont dans un bâteau...</h1><div class=post-meta>May 28, 2010&nbsp;·&nbsp;franek</div></header><div class=post-content><p>Ce <a href=http://franek.chicour.net/>blog</a> et <a href=http://www.chicour.net/>une partie de ces satellites</a> (migration en cours) tournent désormais sur <a href=http://www.cherokee-project.com/>cherokee</a>, un serveur web léger concurrent de Apache, Lighthttpd, nginx,&mldr; Je n&rsquo;ai pas trouvé de ressources sur la configuration de dotclear avec Cherokee donc voici quelques notes. J&rsquo;espère que cela pourra aider certains d&rsquo;entre vous. J&rsquo;essaierai de détailler si besoin.</p><h2 id=installation-de-cherokee>Installation de cherokee<a hidden class=anchor aria-hidden=true href=#installation-de-cherokee>#</a></h2><p>Je vous invite à lire la <a href=http://www.cherokee-project.com/doc/>documentation du projet</a>qui est relativement complète.</p><p>La version 1.0 de Cherokee est depuis peu disponible dans la branche testing de Debian.<br>Si vous utilisez une debian stable, vous pouvez utiliser le <a href=http://wiki.debian.org/AptPreferences>système de Pinning</a> en utilisant les dépôts testing :</p><pre><code>apt-get install cherokee -t testing
</code></pre><h2 id=configuration-de-dotclear>Il faudra également que vous installiez le paquet php5-cgi ainsi que mysql. Il y a plein de tutos sur le net sur ce sujet.<br>Configuration de Dotclear</h2><p>Je vous invite à suivre la <a href=http://fr.dotclear.org/documentation/2.0/admin/clean-install>procédure habituelle</a>. Dans mon cas, dotclear est installé dans le répretoire /usr/share/dotclear-2.1.7. J&rsquo;ai un lien symbolique dotclear2 qui pointe sur dotclear-2.1.7 (qui permet de switcher d&rsquo;une version à l&rsquo;autre).</p><p>J&rsquo;ai un répertoire /usr/share/dotclear2-all-blogs qui contient les thèmes et les plugins communs à l&rsquo;ensemble des blogs hébergés.</p><p>J&rsquo;utilise dotclear en multiblog. Chaque blog dispose dispose des plugins communs. Les thèmes ne sont pas partagés. Chaque blog dispose de son sous-domaine :<br>exemple : user1.domain.net, user2.domain.net</p><p>Ces blogs sont hébergés dans /var/www/<br>Exemple :</p><ul><li>/var/www/domain.net/user1/public_html pour user1.domain.net</li><li>/var/www/domain.net/user2/public_html pour user2.domain.net</li></ul><p>Dans chaque répertoire public_html, j&rsquo;ai donc un fichier index.php dont l&rsquo;identifiant du blog a été modifié et dont le chemin du require a été modifié :</p><pre><code>&lt;p&gt;&lt;?php&lt;br&gt;&lt;/br&gt;define('DC_BLOG_ID','user1'); # identifiant du blog&lt;br&gt;&lt;/br&gt;require '/usr/share/dotclear2/inc/public/prepend.php';&lt;/p&gt;
</code></pre><p>Dans le fichier de configuration, j&rsquo;ai ajouté les lignes suivantes afin de charger les thèmes dans les profils utilisateurs :</p><pre><code>&lt;p&gt;// Modification de la configuration du blog lors de l'initialisation&lt;br&gt;&lt;/br&gt;// cf. http://forum.dotclear.net/viewtopic.php?id=33875&lt;br&gt;&lt;/br&gt;$__top_behaviors[] = array('coreBlogConstruct','modifConfig');&lt;br&gt;&lt;/br&gt;&lt;br&gt;&lt;/br&gt;function modifConfig($blog) {&lt;br&gt;&lt;/br&gt;  $blog-&gt;themes_path = '/var/www/domain.net/'.$blog-&gt;id.'/public_html/themes';&lt;br&gt;&lt;/br&gt;  $blog-&gt;public_path = '/var/www/domain.net/'.$blog-&gt;id.'/public_html/public';&lt;br&gt;&lt;/br&gt;}&lt;/p&gt;
</code></pre><h2 id=configuration-de-cherokee>Tous les blogs sont configurés en mode PATH_INFO.<br>Configuration de cherokee</h2><p>La configuration de cherokee est ultra-basique. J&rsquo;ai un v-servers pour l&rsquo;ensemble des blogs hébergés.<br>Des copies d&rsquo;écran étant souvent plus parlantes que de longs discours, voici ma configuration :</p><h3 id=configuration-générale-du-v-server>Configuration générale du v-server<a hidden class=anchor aria-hidden=true href=#configuration-générale-du-v-server>#</a></h3><p><a href=https://franek.chicour.net/public/cherokee/cherokee_configuration_basics.png><img src=https://franek.chicour.net/public/cherokee/.cherokee_configuration_basics_m.jpg alt title="cherokee_configuration_basics.png, mai 2010"></a></p><h3 id=configuration-des-behaviors>Configuration des behaviors<a hidden class=anchor aria-hidden=true href=#configuration-des-behaviors>#</a></h3><p>Il est nécessaire d&rsquo;ajouter au mininum 3 behaviors :</p><ul><li>Un behavior PHP (afin de pouvoir traiter les requêtes PHP)</li><li>Un behavior admin permettant d&rsquo;accéder à l&rsquo;interface d&rsquo;administration. Le behavor sur le répertoire admin pointe sur /usr/share/dotclear2/admin.</li><li>Modifier le behavior &ldquo;Par défaut&rdquo; afin qu&rsquo;il agisse en tant que redirection vers le fichier index.php (gestion des URL en mode PATH_INFO, suppression de index.php)</li></ul><p><a href=https://franek.chicour.net/public/cherokee/cherokee_configuration_behavior.png><img src=https://franek.chicour.net/public/cherokee/.cherokee_configuration_behavior_m.jpg alt title="cherokee_configuration_behavior.png, mai 2010"></a></p><h3 id=configuration-du-behavior-par-défaut>Configuration du Behavior par défaut<a hidden class=anchor aria-hidden=true href=#configuration-du-behavior-par-défaut>#</a></h3><p>Cette configuration est nécessaire si vous souhaitez supprimer le fichier index.php dans les URL et que vous utilisez le mode PATH_INFO.</p><p><a href=https://franek.chicour.net/public/cherokee/cherokee_configuration_redirection.png><img src=https://franek.chicour.net/public/cherokee/.cherokee_configuration_redirection_m.jpg alt title="cherokee_configuration_redirection.png, mai 2010"></a></p><p>Je n&rsquo;ai pas encore configuré cherokee afin qu&rsquo;il gère correctement le cache des contenus statiques (ajout de date d&rsquo;expiration,&mldr;). Si ce n&rsquo;est pas clair, n&rsquo;hésitez pas à commenter, j&rsquo;essaierai de compléter.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://franek.chicour.net/tags/d%C3%A9veloppement-web/>développement web</a></li><li><a href=https://franek.chicour.net/tags/cherokee/>cherokee</a></li><li><a href=https://franek.chicour.net/tags/dotclear/>dotclear</a></li><li><a href=https://franek.chicour.net/tags/installation/>installation</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://franek.chicour.net>::franek::</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=https://franek.chicour.net/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});if(id==="top"){history.replaceState(null,null," ");}else{history.replaceState(null,null,`#${id}`);}});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script></body></html>